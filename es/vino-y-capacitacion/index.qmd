---
title: "Gestionar capacitaci칩n buscando el mejor vino"
lang: es 
author: "Checho"
date: "01/23/2025"
format:
  html:
    toc: true
    toc-location: left
    code-fold: true
    code-summary: "Ver c칩digo"
    code-copy: hover
categories: [ggplot2, proyectos, capacitaci칩n, training, tidyverse, dplyr, data viz, people analytics, fun, r, python, tidytuesday]
execute: 
  warning: false
  error: false
  message: false
  dpi: 600
---

# C칩mo la b칰squeda de los mejores vinos de Mendoza puede ayudar a la gesti칩n de proveedores de capacitaci칩n

![Yo durante mi luna de miel en Finca Adelma.](IMG_20220316_132649177_HDR.jpg){fig-align="left" width="292"}

El objetivo de este post es mostrar c칩mo se puede aplicar un an치lisis de un tema cualquiera, a un problema de RRHH.

La raz칩n detr치s de esta idea es que cuando estamos aprendiendo a usar cualquier programa de an치lisis de datos, ll치mese R, Python, Power BI o Excel, encontramos mucho contenido sobre muchos tipos de an치lisis, pero muy poco contenido relacionado con RRHH. **Y eso es algo que podemos hacer por nuestra cuenta.**

Con esto en mente, lo que vamos a hacer es ver c칩mo podemos aprovechar un an치lisis en el cual buscamos en qu칠 regi칩n de Mendoza podemos hallar los mejores malbecs[^1], haciendo un r치nking de las mejores regiones. Luego veremos c칩mo ese mismo tipo de an치lisis lo podemos usar para **detectar cu치les son los mejores proveedores de capacitaci칩n de una empresa**.

[^1]: Mendoza es la provincia m치s importante en producci칩n de vinos de Argentina, y la cepa m치s representativa del pa칤s es el malbec.

# Primer An치lisis: D칩nde encontrar los mejores vinos

Para el primer ejercicio vamos a imaginar que estamos planeando un viaje a Mendoza, y queremos saber en qu칠 regi칩n se producen los mejores malbecs.

Vamos a usar un dataset que se llama [Wine Ratings Dataset](https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-05-28) que lo comparti칩 la comunidad de R a trav칠s su iniciativa [#TidyTuesday](https://github.com/rfordatascience/tidytuesday) en la que cada martes, comparten un dataset diferente para que cualquier persona pueda practicar y compartir su trabajo. Ah칤 se puede encontrar datos sobre casi cualquier cosa.

Manos a la obra... Sal칰! 游꽁

## Librer칤as y datos

Vamos a usar varios paquetes dentro de `tidyverse` y cargamos los datos directamente desde el repositorio de GitHub del proyecto TidyTuesday.

```{r}
library(tidyverse)

# Carga de datos
wine_ratings <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-28/winemag-data-130k-v2.csv")

# Filtramos los datos de la provincia de Mendoza
wine_ar <- wine_ratings %>% 
  filter(province == "Mendoza Province") 
```

El dataset original contiene `r nrow(wine_ratings)` filas y `r ncol(wine_ratings)`. Despu칠s de filtrar los datos s칩lo por `Mendoza Province` nos quedamos con `r nrow(wine_ar)` filas que representan los puntajes que personas expertas le han dado a los vinos. De ahora en m치s seguiremos trabajando con el dataset `wine_ar`.

```{r}
# Exploremos el contenido del dataset
glimpse(wine_ar)
```

Solo de explorar el dataset se me hace agua la boca. En fin, sigamos...

## Calcular puntaje promedio de vinos por regiones

El paso siguiente es filtrar por la cepa `Malbec` y luego podemos calcular un promedio de los puntajes de la columna `points` agrupados por la columna `region_1` as칤 podemos establecer un ranking de las regiones que tienen los mejores Malbecs de Mendoza.

```{r}
# Filtramos por Malbec
malbec <- wine_ar %>% 
  filter(variety == "Malbec")

# Creamos un ranking de las mejores regiones productoras de Malbec
promedio_regiones <- malbec %>% 
  filter(!is.na(region_1)) %>%  # Eliminamos filas sin datos
  group_by(region_1) %>%        # Agrupamos por region
  summarise(puntaje_promedio = mean(points)) %>% # Calculamos el promedio
  arrange(desc(puntaje_promedio)) # Ordenamos de mayor a menor

# Ver el resultado
promedio_regiones
```

De esta manera descubrimos, para mi sorpresa incluso, que en Perdriel (una [localidad](https://es.wikipedia.org/wiki/Perdriel_(Mendoza)) dentro de Luj치n de Cuyo) podemos encontrar los mejores malbecs de la provincia.

Y ahora esto lo podemos visualizar en un gr치fico.

```{r}
ggplot(promedio_regiones, aes(x = puntaje_promedio, 
                              y = reorder(region_1, puntaje_promedio))) + # Ordenamos las regiones por puntaje_promedio
  geom_col(fill = "#82163D") + # Color malbec ;p
  theme_minimal()  + # Modificamos el estilo del gr치fico
  # A침adimos el t칤tulo al gr치fico y a los ejes
  labs(title = "Ranking de regiones de Mendoza con los mejores Malbec", 
       x = "Puntaje Promedio",
       y = "Regi칩n de Mendoza") +
  theme(title = element_text(color = "#82163D"),
        plot.title.position = "plot") +
  # A침adimos el puntaje a cada barra
  geom_text(aes(label = round(puntaje_promedio,1)),
            size = 2.5,
            color = "white",
            hjust = 1.2) 

# Guardamos el gr치fico en un archivo png
ggsave("output/ranking_regiones.png", dpi = 300, create.dir = TRUE)
```

As칤 podemos ver f치cilmente las localidades con los mejores vinos malbec, y podr칤amos planificar el viaje asegur치ndonos de visitar las mejores bodegas.

Despu칠s me agradecen.

![](https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExa3RpMWlkZGhpam9zdWs4MmoweXkzM3drcm45ZzFleXdzOTk4MjdrbyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/8Iv5lqKwKsZ2g/giphy.gif)

# Segundo An치lisis: 쮺u치les son los mejores proveedores de capacitaci칩n en mi empresa?

C칩mo dec칤a anteriormente. Es probable que si trabajamos en un equipo de Capacitaci칩n, y busquemos c칩mo hacer un an치lisis de proveedores de capacitaci칩n, no encontremos ning칰n art칤culo que nos ense침e a hacerlo.

Pero, podemos usar el ejemplo del ranking de vinos para hacer un an치lisis similar usando las encuestas de capacitaci칩n que hacemos completar a nuestros empleados despu칠s que terminan un curso.

## Los datos

Para realizar este ejercicio, vamos a usar un dataset ficticio, que simula compilar resultados de encuestas de capacitaci칩n, e incluye m칠tricas como:

-   **satisfaction:** eval칰a en qu칠 medida el curso gust칩 o no.

-   **facilitator_score:** punt칰a la calidad del facilitador/a de la actividad.

-   **materials_satisfaction:** mide la satisfacci칩n con los materiales provistos por el proveedor del curso.

-   **willing_recommend:** eval칰a si recomendar칤a el curso o no.

-   **area_goals_alignment:** mide en qu칠 porcentaje el curso est치 alineado con los objetivos del 치rea.

-   **work_aplication:** en qu칠 medida el contenido del curso se puede trasladar al trabajo.

-   **scrap_learning:** mide cu치nto del contenido de la actividad no tiene aplicaci칩n en el trabajo (leer m치s en [este art칤culo](https://chechoid.netlify.app/posts/scrap_learning/)).

```{r}
# Carga de datos
training <- read_delim("data/training_ratings.csv",
                       delim = ";")

# Explorar dataset
glimpse(training)
```

Como podemos apreciar, hay muchas dimensiones en las que nos podemos enfocar para medir la calidad de nuestros proveedores de capacitaci칩n. Para este ejercicio vamos a **analizar a los proveedores seg칰n qu칠 tan alineados est치n con los objetivos del 치rea**.

쯇or qu칠 vamos a analizar a los proveedores seg칰n su alineaci칩n con los objetivos?

![](no_hay_porque.jpg){fig-align="left" width="458"}

### Par칠ntesis: Nombres de los proveedores de capacitaci칩n

Casi todos los datos de este dataset son inventados por m칤, los puntajes fueron generados aleatoriamente, pero los nombres de los proveedores y de los cursos los saqu칠 de los proveedores y cursos que ten칤amos en Pilkington de la 칠poca que trabaj칠 ah칤 (2010-2016).

As칤 que para no herir susceptibilidades, ni que se malinterprete la informaci칩n que vamos a generar, vamos a usar el paquete `noah` que lo que hace es generar nombres aleatorios para enmascarar los nombres reales, y mostrar un nombre simp치tico en vez del real.

![](https://teebusch.github.io/noah/reference/figures/logo.png){fig-align="left" width="205"}

```{r}
# Cargar la librer칤a
# install.packages("noah")
library(noah)

# Crear columna con nombres random
training <- training %>% 
    mutate(pseudo_supplier = pseudonymize(supplier)) 

# Guardamos el archivo nuevo
write_delim(training, "output/training_data_fake_names.csv", delim = ";")

# Veamos los nombres nuevos que tienen los proveedores con este cambio
fake_names <- unique(training$pseudo_supplier)

fake_names
```

쯈ui칠n no querr칤a hacer un curso en `r fake_names[1]`? 游때

Cierro par칠ntesis.

## Calcular proveedores mejor alineados con los objetivos del 치rea

El siguiente paso es calcular el promedio de alineaci칩n con objetivos por cada proveedor. De nuevo, podr칤a ser por cualquier m칠trica, pero para este art칤culo elejimos esa.

Como la idea del an치lisis es analizar proveedores externos. Vamos a filtrar los cursos dictados internamente, y luego vamos a calcular el promedio de alineaci칩n con objetivos para cada proveedor.

```{r}
# Crear un dataset de proveedores externos
external_vendors <- training %>% 
  filter(supplier != "INTERNO") # Elimina las filas de cursos internos

# Calculamos el puntaje promedio de alineaci칩n para cada proveedor
vendor_alignment_score <-  external_vendors %>% 
  group_by(pseudo_supplier) %>% 
  summarise(puntaje_promedio = mean(area_goals_alignment)) %>%
  arrange(desc(puntaje_promedio))

# Veamos el ranking
vendor_alignment_score
```

De esta manera podemos ver que *`r pull(vendor_alignment_score[1,1])`* es el mejor proveedor con un puntaje de `r scales::percent(pull(vendor_alignment_score[1,2]),accuracy = 0.1)` y que el peor proveedor es *`r pull(vendor_alignment_score[nrow(vendor_alignment_score),1])`*.

Con estos datos podemos hacer un gr치fico de la misma manera que lo hicimos con el gr치fico de vinos.

```{r}
ggplot(vendor_alignment_score, aes(x = puntaje_promedio, 
                              y = reorder(pseudo_supplier, puntaje_promedio))) + # Ordenamos los vendors por puntaje_promedio
  geom_col(fill = "#103F79") +
  theme_minimal()  + # Modificamos el estilo del gr치fico
  # A침adimos el t칤tulo al gr치fico y a los ejes
  labs(title = "Ranking de proveedores de capacitaci칩n",
       subtitle = "Ordenados por Alineaci칩n con Objetivos del 츼rea",
       x = "Puntaje Promedio",
       y = "Vendor",
       caption = "Datos generados aleatoriamente") +
  theme(title = element_text(color = "#103F79"),
        plot.title.position = "plot") +
  # A침adimos el puntaje a cada barra
  geom_text(aes(label = scales::percent(puntaje_promedio,
                                        accuracy = 0.1)),
            size = 2.5,
            color = "white",
            hjust = 1.2) +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1))

# Guardamos el gr치fico en un archivo png
ggsave("output/ranking_proveedores_basico.png", dpi = 300, create.dir = TRUE)
```

Incluso podemos ir un paso m치s all치 y agregar una l칤nea que nos indique el target de alineaci칩n m칤nimo. De esta manera podremos saber qu칠 proveedores debemos mantener s칤 o s칤 independiemente del costo, y cu치les son los vendors que tenemos que reemplazar.

```{r}
ggplot(vendor_alignment_score, aes(x = puntaje_promedio, 
                              y = reorder(pseudo_supplier, puntaje_promedio))) + # Ordenamos los vendors por puntaje_promedio
  geom_col(fill = "#103F79") +
  theme_minimal()  + # Modificamos el estilo del gr치fico
  # A침adimos el t칤tulo al gr치fico y a los ejes
  labs(title = "Ranking de proveedores de capacitaci칩n",
       subtitle = "Ordenados por Alineaci칩n con Objetivos del 츼rea",
       x = "Puntaje Promedio",
       y = "Vendor",
       caption = "Datos generados aleatoriamente") +
  theme(title = element_text(color = "#103F79"),
        plot.title.position = "plot") +
  # A침adimos el puntaje a cada barra
  geom_text(aes(label = scales::percent(puntaje_promedio,
                                        accuracy = 0.1)),
            size = 2.5,
            color = "white",
            hjust = 1.2) +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
  # Definimos un umbral de 60% con una l칤nea punteada amarilla
  geom_vline(xintercept = 0.6,
             color = "#F3B229",
             linetype = 2,
             linewidth = 1)

# Guardamos el gr치fico en un archivo png
ggsave("output/ranking_proveedores.png", dpi = 300, create.dir = TRUE)
```

Incluso podr칤amos asignar colores distintos a los proveedores cuyo puntaje sea inferior al 40% para indicar de esa manera qu칠 proveedores deber칤an ser reemplazados.

```{r}
# Guardemos el gr치fico en un objeto para simplificar la lectura
p <- ggplot(vendor_alignment_score, aes(x = puntaje_promedio, 
                              y = reorder(pseudo_supplier, puntaje_promedio))) + 
  # Definimos los cortes en funci칩n del puntaje promedio
  geom_col(aes(fill = cut(puntaje_promedio,
                           c(-Inf,0.4, Inf)))) 
# Los valores van de menos infinito, a 0.4, y luego hasta el infinito

# Veamos este paso
p

# Ahora asignemos el color en funci칩n de los valores de puntaje_promedio
# Si el valor es mayor a 0.4 (40%) entonces el color es azul.
# Si el valor es menor a 0.4, entonces el color de la barra ser치 naranja.
p <- p +
  scale_fill_manual(values = c("(-Inf,0.4]" = "#F7B234",
                               "(0.4, Inf]" = "#103F79"),
                    labels = c("Reemplazar", "Mantener")
                    )
# Veamos como queda hasta ahora
p

# Gr치fico final con todos los lujos
p +
  # A침adimos el t칤tulo al gr치fico y a los ejes
  labs(title = "Ranking de proveedores de capacitaci칩n",
       subtitle = "Ordenados por Alineaci칩n con Objetivos del 츼rea",
       x = "Puntaje Promedio",
       y = "Vendor",
       caption = "Datos generados aleatoriamente",
       fill = "Acci칩n") +
  # A침adimos el puntaje a cada barra
  geom_text(aes(label = scales::percent(puntaje_promedio,
                                        accuracy = 0.1)),
            size = 2.5,
            color = "white",
            hjust = 1.2) +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
  # Definimos un umbral de 60% con una l칤nea punteada amarilla
  geom_vline(xintercept = 0.6,
             color = "#F3B229",
             linetype = 2,
             linewidth = 1) +
  theme_minimal() +  # Modificamos el estilo del gr치fico
  guides(fill = guide_legend(reverse=TRUE)) +
  theme(title = element_text(color = "#103F79"),
        plot.title.position = "plot",
        legend.position = "top") 


ggsave("output/ranking_proveedores_final.png")
  
```

# Conclusi칩n

En este ejercicio podemos ver como un an치lisis aplicado a realizar un ranking de mejores lugares para encontrar vinos nos sirve como *inspiraci칩n* para realizar un ranking de los mejores proveedores de capacitaci칩n.

Hacer este tipo de ejercicios me parece muy importante por dos motivos:

-   No siempre vamos a encontrar precisamente lo que necesitamos.
-   A veces haciendo cosas *divertidas* podemos aprender a usar una herramienta (ll치mese, R, Excel, Power BI o Python) y luego aplicar lo que aprendemos a lo que necesitamos.

Estoy seguro que si googleamos *"c칩mo hacer un ranking de capacitaci칩n en (inserte su herramienta aqu칤)"*, probablemente no encontremos mucha informaci칩n, en cambio si buscamos c칩mo hacer un ranking en "x" tecnolog칤a, hallaremos muchos recursos para aprender como hacerlo.

Por siempre en cada proyecto de datos, **lo m치s importante es saber qu칠 queremos lograr**, qu칠 es lo que estamos buscando, cu치l es el problema que tenemos que resolver, para qu칠, etc., etc., etc.. La parte t칠cnica se resuelve f치cil cuando sabemos cu치l es nuestro objetivo.

Espero que les haya gustado este ejercicio. Pr칩ximamente subir칠 el c칩digo para hacerlo en Python, as칤 que stay tuned!

![](https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExNTB3YnRidWxybXp5bTB6ZDdwNnY5amZhMm90eXJqOG5uejVsNW5xNyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3ohjUSrMV1hm4BmG9a/giphy.gif)
